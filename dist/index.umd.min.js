!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).elevator=e()}(this,(function(){"use strict";class Queue{constructor(t,e){this.maxConcurrent=t||1,this.minCycle=e||0,this.queueRunning=[],this.queueWaiting={},this.lastRun=0}dequeue(t){const e=this.queueRunning,s=e.findIndex((e=>e.hash===t));if(-1==s)throw"queue desync";const i=e[s];return e.splice(s,1),i}getFirstWaiting(){for(let t of Object.keys(this.queueWaiting).sort(((t,e)=>t-e)))if(void 0!==this.queueWaiting[t]&&this.queueWaiting[t].length>0)return this.queueWaiting[t]}end(t){this.dequeue(t).resolve();const e=this.getFirstWaiting();if(void 0!==e){e.shift().resolve()}}async wait(t,e){const s=void 0===e?0:e;let i={hash:t,priority:s};for(null==this.queueWaiting[s]&&(this.queueWaiting[s]=[]),this.queueRunning.length>=this.maxConcurrent&&(i.promise=new Promise((t=>{i.resolve=t})),this.queueWaiting[s].push(i),await i.promise),this.queueRunning.push(i),i.promise=new Promise((t=>{i.resolve=t}));Date.now()-this.lastRun<this.minCycle;)await new Promise((t=>setTimeout(t,this.minCycle-Date.now()+this.lastRun)));this.lastRun=Date.now()}run(t,e){const s=void 0===e?0:e,i=Symbol();return this.wait(i,s).then((()=>t())).finally((t=>(this.end(i),t)))}stat(){return{running:this.queueRunning.length,waiting:Object.keys(this.queueWaiting).reduce(((t,e)=>t+this.queueWaiting[e].length),0),last:this.lastRun}}async flush(){for(;this.stat().waiting>0;)for(let t of Object.keys(this.queueWaiting).sort(((t,e)=>e-t))){const e=this.queueWaiting[t];void 0!==e&&e.length>0&&await e[e.length-1].promise}for(;this.queueRunning.length>0;)await Promise.allSettled(this.queueRunning.map((t=>t.promise)))}}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(t,e,s){return t(s={path:e,exports:{},require:function(t,e){return commonjsRequire(t,null==e?s.path:e)}},s.exports),s.exports}function commonjsRequire(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var sha1=createCommonjsModule((function(module){
/*
	 * [js-sha1]{@link https://github.com/emn178/js-sha1}
	 *
	 * @version 0.6.0
	 * @author Chen, Yi-Cyuan [emn178@gmail.com]
	 * @copyright Chen, Yi-Cyuan 2014-2017
	 * @license MIT
	 */
(function(){var root="object"==typeof window?window:{},NODE_JS=!root.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS&&(root=commonjsGlobal);var COMMON_JS=!root.JS_SHA1_NO_COMMON_JS&&module.exports,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=function(t){return function(e){return new Sha1(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Sha1},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var s=OUTPUT_TYPES[e];t[s]=createOutputMethod(s)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(t){if("string"==typeof t)return crypto.createHash("sha1").update(t,"utf8").digest("hex");if(t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(void 0===t.length)return method(t);return crypto.createHash("sha1").update(new Buffer(t)).digest("hex")};return nodeMethod};function Sha1(t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(t){if(!this.finalized){var e="string"!=typeof t;e&&t.constructor===root.ArrayBuffer&&(t=new Uint8Array(t));for(var s,i,o=0,n=t.length||0,r=this.blocks;o<n;){if(this.hashed&&(this.hashed=!1,r[0]=this.block,r[16]=r[1]=r[2]=r[3]=r[4]=r[5]=r[6]=r[7]=r[8]=r[9]=r[10]=r[11]=r[12]=r[13]=r[14]=r[15]=0),e)for(i=this.start;o<n&&i<64;++o)r[i>>2]|=t[o]<<SHIFT[3&i++];else for(i=this.start;o<n&&i<64;++o)(s=t.charCodeAt(o))<128?r[i>>2]|=s<<SHIFT[3&i++]:s<2048?(r[i>>2]|=(192|s>>6)<<SHIFT[3&i++],r[i>>2]|=(128|63&s)<<SHIFT[3&i++]):s<55296||s>=57344?(r[i>>2]|=(224|s>>12)<<SHIFT[3&i++],r[i>>2]|=(128|s>>6&63)<<SHIFT[3&i++],r[i>>2]|=(128|63&s)<<SHIFT[3&i++]):(s=65536+((1023&s)<<10|1023&t.charCodeAt(++o)),r[i>>2]|=(240|s>>18)<<SHIFT[3&i++],r[i>>2]|=(128|s>>12&63)<<SHIFT[3&i++],r[i>>2]|=(128|s>>6&63)<<SHIFT[3&i++],r[i>>2]|=(128|63&s)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=r[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=EXTRA[3&e],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},Sha1.prototype.hash=function(){var t,e,s=this.h0,i=this.h1,o=this.h2,n=this.h3,r=this.h4,h=this.blocks;for(t=16;t<80;++t)e=h[t-3]^h[t-8]^h[t-14]^h[t-16],h[t]=e<<1|e>>>31;for(t=0;t<20;t+=5)s=(e=(i=(e=(o=(e=(n=(e=(r=(e=s<<5|s>>>27)+(i&o|~i&n)+r+1518500249+h[t]<<0)<<5|r>>>27)+(s&(i=i<<30|i>>>2)|~s&o)+n+1518500249+h[t+1]<<0)<<5|n>>>27)+(r&(s=s<<30|s>>>2)|~r&i)+o+1518500249+h[t+2]<<0)<<5|o>>>27)+(n&(r=r<<30|r>>>2)|~n&s)+i+1518500249+h[t+3]<<0)<<5|i>>>27)+(o&(n=n<<30|n>>>2)|~o&r)+s+1518500249+h[t+4]<<0,o=o<<30|o>>>2;for(;t<40;t+=5)s=(e=(i=(e=(o=(e=(n=(e=(r=(e=s<<5|s>>>27)+(i^o^n)+r+1859775393+h[t]<<0)<<5|r>>>27)+(s^(i=i<<30|i>>>2)^o)+n+1859775393+h[t+1]<<0)<<5|n>>>27)+(r^(s=s<<30|s>>>2)^i)+o+1859775393+h[t+2]<<0)<<5|o>>>27)+(n^(r=r<<30|r>>>2)^s)+i+1859775393+h[t+3]<<0)<<5|i>>>27)+(o^(n=n<<30|n>>>2)^r)+s+1859775393+h[t+4]<<0,o=o<<30|o>>>2;for(;t<60;t+=5)s=(e=(i=(e=(o=(e=(n=(e=(r=(e=s<<5|s>>>27)+(i&o|i&n|o&n)+r-1894007588+h[t]<<0)<<5|r>>>27)+(s&(i=i<<30|i>>>2)|s&o|i&o)+n-1894007588+h[t+1]<<0)<<5|n>>>27)+(r&(s=s<<30|s>>>2)|r&i|s&i)+o-1894007588+h[t+2]<<0)<<5|o>>>27)+(n&(r=r<<30|r>>>2)|n&s|r&s)+i-1894007588+h[t+3]<<0)<<5|i>>>27)+(o&(n=n<<30|n>>>2)|o&r|n&r)+s-1894007588+h[t+4]<<0,o=o<<30|o>>>2;for(;t<80;t+=5)s=(e=(i=(e=(o=(e=(n=(e=(r=(e=s<<5|s>>>27)+(i^o^n)+r-899497514+h[t]<<0)<<5|r>>>27)+(s^(i=i<<30|i>>>2)^o)+n-899497514+h[t+1]<<0)<<5|n>>>27)+(r^(s=s<<30|s>>>2)^i)+o-899497514+h[t+2]<<0)<<5|o>>>27)+(n^(r=r<<30|r>>>2)^s)+i-899497514+h[t+3]<<0)<<5|i>>>27)+(o^(n=n<<30|n>>>2)^r)+s-899497514+h[t+4]<<0,o=o<<30|o>>>2;this.h0=this.h0+s<<0,this.h1=this.h1+i<<0,this.h2=this.h2+o<<0,this.h3=this.h3+n<<0,this.h4=this.h4+r<<0},Sha1.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,s=this.h2,i=this.h3,o=this.h4;return HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]},Sha1.prototype.toString=Sha1.prototype.hex,Sha1.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,s=this.h2,i=this.h3,o=this.h4;return[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,s>>24&255,s>>16&255,s>>8&255,255&s,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o]},Sha1.prototype.array=Sha1.prototype.digest,Sha1.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};var exports=createMethod();COMMON_JS?module.exports=exports:root.sha1=exports})()}));class elevator{constructor(t){this.asyncQueue=new Queue(3,100),this.options=t}async getAssetsFromCollection(t,e){const s="/collections/getContentsOfCollection/"+t+"/"+(e||"");return this._performRequest(s)}async getAssetChildren(t){const e="/asset/getAssetChildren/"+t;return this._performRequest(e)}async getEmbedContent(t){const e="/asset/getEmbedLink/"+t;return this._performRequest(e)}async assetLookup(t){const e="/asset/assetLookup/"+t;return this._performRequest(e)}async fileLookup(t){const e="/asset/fileLookup/"+t;return this._performRequest(e)}async getCollections(){return this._performRequest("/collections/listCollections")}async search(t,e=0){let s=new FormData;s.append("searchTerm",t),s.append("pageNumber",e.toString());return this._performRequest("/search/performSearch/",s)}async _performRequest(t,e){const s=Symbol();await this.asyncQueue.wait(s,-1);const i=new Date,o=Math.round(i.getTime()/1e3).toString(),n=sha1(o+this.options.secret);let r=new Headers({"Authorization-Key":this.options.key,"Authorization-Timestamp":o,"Authorization-Hash":n});this.options.user&&r.set("Authorization-User",this.options.user);let h={method:"GET",mode:"cors",headers:r};e&&(h.method="POST",h.body=e);const a=await fetch(this.options.baseURL+t,h);return this.asyncQueue.end(s),a.json()}}return elevator}));
